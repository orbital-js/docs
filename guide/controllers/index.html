



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Official Documentation for the Orbital CLI Framework">
      
      
        <link rel="canonical" href="https://docs.orbital.sh/guide/controllers/">
      
      
        <meta name="author" content="Orbital Team">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.6.0">
    
    
      
        <title>Controllers - Orbital Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.aa3de92b.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.792431c1.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../assets/styles/custom.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="green">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#metadata" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.orbital.sh" title="Orbital Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Orbital Docs
              </span>
              <span class="md-header-nav__topic">
                Controllers
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/orbital-js/docs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      orbital-js/docs
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../introduction/" title="Guide" class="md-tabs__link md-tabs__link--active">
          Guide
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Orbital Docs
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/orbital-js/docs/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      orbital-js/docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Controllers
      </label>
    
    <a href="./" title="Controllers" class="md-nav__link md-nav__link--active">
      Controllers
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#metadata" title="Metadata" class="md-nav__link">
    Metadata
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-object" title="Request Object" class="md-nav__link">
    Request Object
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typescript" title="TypeScript" class="md-nav__link">
    TypeScript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript" title="JavaScript" class="md-nav__link">
    JavaScript
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-endpoints" title="More Endpoints" class="md-nav__link">
    More Endpoints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#status-code-manipulation" title="Status Code Manipulation" class="md-nav__link">
    Status Code Manipulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#route-parameters" title="Route parameters" class="md-nav__link">
    Route parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#async-await" title="Async / Await" class="md-nav__link">
    Async / Await
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typescript_1" title="TypeScript" class="md-nav__link">
    TypeScript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript_1" title="JavaScript" class="md-nav__link">
    JavaScript
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observables" title="Observables" class="md-nav__link">
    Observables
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typescript_2" title="TypeScript" class="md-nav__link">
    TypeScript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript_2" title="JavaScript" class="md-nav__link">
    JavaScript
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-handler" title="POST handler" class="md-nav__link">
    POST handler
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typescript_3" title="TypeScript" class="md-nav__link">
    TypeScript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript_3" title="JavaScript" class="md-nav__link">
    JavaScript
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" title="Error Handling" class="md-nav__link">
    Error Handling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#last-step" title="Last Step" class="md-nav__link">
    Last Step
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#express-approach" title="Express Approach" class="md-nav__link">
    Express Approach
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typescript_4" title="TypeScript" class="md-nav__link">
    TypeScript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript_4" title="JavaScript" class="md-nav__link">
    JavaScript
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../components/" title="Components" class="md-nav__link">
      Components
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#metadata" title="Metadata" class="md-nav__link">
    Metadata
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-object" title="Request Object" class="md-nav__link">
    Request Object
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typescript" title="TypeScript" class="md-nav__link">
    TypeScript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript" title="JavaScript" class="md-nav__link">
    JavaScript
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#more-endpoints" title="More Endpoints" class="md-nav__link">
    More Endpoints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#status-code-manipulation" title="Status Code Manipulation" class="md-nav__link">
    Status Code Manipulation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#route-parameters" title="Route parameters" class="md-nav__link">
    Route parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#async-await" title="Async / Await" class="md-nav__link">
    Async / Await
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typescript_1" title="TypeScript" class="md-nav__link">
    TypeScript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript_1" title="JavaScript" class="md-nav__link">
    JavaScript
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#observables" title="Observables" class="md-nav__link">
    Observables
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typescript_2" title="TypeScript" class="md-nav__link">
    TypeScript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript_2" title="JavaScript" class="md-nav__link">
    JavaScript
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-handler" title="POST handler" class="md-nav__link">
    POST handler
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typescript_3" title="TypeScript" class="md-nav__link">
    TypeScript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript_3" title="JavaScript" class="md-nav__link">
    JavaScript
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" title="Error Handling" class="md-nav__link">
    Error Handling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#last-step" title="Last Step" class="md-nav__link">
    Last Step
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#express-approach" title="Express Approach" class="md-nav__link">
    Express Approach
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typescript_4" title="TypeScript" class="md-nav__link">
    TypeScript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#javascript_4" title="JavaScript" class="md-nav__link">
    JavaScript
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/orbital-js/docs/edit/master/docs/guide/controllers.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Controllers</h1>
                
                <p>The controllers layer is responsible for handling incoming <strong>requests</strong>, and return a <strong>response</strong> to the client.
<img src="/assets/images/Controllers_1.png" /></p>
<p>To create a basic controller you have to attach the <strong>metadata</strong> to the class. Thanks to the metadata Nest knows how to map your controller into the appropriate routes. To attach the metadata we're using the <strong>decorators</strong> (in this case <code class="codehilite">@Controller(&#39;cats&#39;)</code>).</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">Controller</span><span class="p">,</span> <span class="nx">Get</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>

<span class="kd">@Controller</span><span class="p">(</span><span class="s1">&#39;cats&#39;</span><span class="p">)</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">CatsController</span> <span class="p">{</span>
    <span class="kd">@Get</span><span class="p">()</span>
    <span class="nx">findAll() {</span>
        <span class="k">return</span> <span class="p">[];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h2 id="metadata">Metadata</h2>
<p>We're using <code class="codehilite">@Controller(&#39;cats&#39;)</code> here. This decorator is <strong>obligatory</strong>. The <code class="codehilite">cats</code> is a prefix for each route registered in the class. The prefix is <strong>optional</strong> what means that you could leave the parentheses empty (<code class="codehilite">@Controller()</code>), but it reduces redundant boilerplate code, thus you don't have to repeat yourself every time when you'd decide to create a new endpoint (route).</p>
<p>There's a single public method, the <code class="codehilite">findAll()</code>, which returns an empty array. The <code class="codehilite">@Get()</code> decorator tells Nest that it's necessary to create an endpoint for this route path and map every appropriate request to this handler. Since we declared the prefix for every route (<code class="codehilite">cats</code>), Nest will map every <code class="codehilite">/cats</code> <strong>GET</strong> request here.</p>
<p>When a client would call this endpoint, Nest will return with 200 status code, and the parsed <strong>JSON</strong>, so in this case - just an empty array. How is that possible?</p>
<p>There are <strong>two possible approaches</strong> of manipulating the response:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Standard (recommended)</td>
<td>We're treating the handlers in the same way as plain functions. When we return the JavaScript object or array, it'd be <strong>automatically</strong>  transformed to JSON. When we return the string, Nest will send just a string. Furthermore, the response <strong>status code</strong> is always 200 by default, except POST requests, when it's <strong>201</strong>. We can easily change this behavior by adding the <code class="codehilite">@HttpCode(...)</code> decorator at a handler-level.</td>
</tr>
<tr>
<td>Express</td>
<td>We can use the express <a href="http://expressjs.com/en/api.html#res">response</a>, which we can inject using <code class="codehilite">@Res()</code> decorator in the function signature, for example <code class="codehilite">findAll(@Res() response)</code>.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It's forbidden to use both two approaches at the same time. Nest detects whether the handler is using <code class="codehilite">@Res()</code> or <code class="codehilite">@Next()</code>, and if it's truth - the standard way is disabled for this single route.</p>
</div>
<h2 id="request-object">Request Object</h2>
<p>A lot of endpoints need an access to the client <strong>request</strong> details. In fact, Nest is using express <a href="http://expressjs.com/en/api.html#req">request</a> object. We can force Nest to inject the request object into handler using <code class="codehilite">@Req()</code> decorator.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>There's a <code class="codehilite">@types/express</code> package and we strongly recommend to use it (<code class="codehilite">Request</code> has its own typings).</p>
</div>
<h3 id="typescript">TypeScript</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">Controller</span><span class="p">,</span> <span class="nx">Get</span><span class="p">,</span> <span class="nx">Req</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>

<span class="kd">@Controller</span><span class="p">(</span><span class="s1">&#39;cats&#39;</span><span class="p">)</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">CatsController</span> <span class="p">{</span>
    <span class="kd">@Get</span><span class="p">()</span>
    <span class="nx">findAll</span><span class="p">(</span><span class="kd">@Req</span><span class="p">()</span> <span class="nx">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h3 id="javascript">JavaScript</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">Controller</span><span class="p">,</span> <span class="nx">Bind</span><span class="p">,</span> <span class="nx">Get</span><span class="p">,</span> <span class="nx">Req</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Controller</span><span class="p">(</span><span class="s1">&#39;cats&#39;</span><span class="p">)</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">CatsController</span> <span class="p">{</span>
    <span class="err">@</span><span class="nx">Get</span><span class="p">()</span>
    <span class="err">@</span><span class="nx">Bind</span><span class="p">(</span><span class="nx">Req</span><span class="p">())</span>
    <span class="nx">findAll</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>The request object represents the HTTP request and has properties for the request query string, parameters, HTTP headers, and e.g. body (read more <a href="http://expressjs.com/en/api.html#req" target="blank">here</a>), but in most cases, it's not necessary to grab them manually.
 We can use <strong>dedicated decorators</strong> instead, such as <code class="codehilite">@Body()</code> or <code class="codehilite">@Query()</code>, which are available out of the box.
 Below is a comparison of the decorators with the plain express objects.</p>
<table>
<thead>
<tr>
<th>Decorator</th>
<th>Express Equivalent</th>
</tr>
</thead>
<tbody>
<tr>
<td><code class="codehilite">@Request()</code></td>
<td><code class="codehilite">req</code></td>
</tr>
<tr>
<td><code class="codehilite">@Response()</code></td>
<td><code class="codehilite">res</code></td>
</tr>
<tr>
<td><code class="codehilite">@Next()</code></td>
<td><code class="codehilite">next</code></td>
</tr>
<tr>
<td><code class="codehilite">@Session()</code></td>
<td><code class="codehilite">req.session</code></td>
</tr>
<tr>
<td><code class="codehilite">@Param(param?: string)</code></td>
<td><code class="codehilite">req.params</code> / <code class="codehilite">req.params[param]</code></td>
</tr>
<tr>
<td><code class="codehilite">@Body(param?: string)</code></td>
<td><code class="codehilite">req.body</code> / <code class="codehilite">req.body[param]</code></td>
</tr>
<tr>
<td><code class="codehilite">@Query(param?: string)</code></td>
<td><code class="codehilite">req.query</code> / <code class="codehilite">req.query[param]</code></td>
</tr>
<tr>
<td><code class="codehilite">@Headers(param?: string)</code></td>
<td><code class="codehilite">req.headers</code> / <code class="codehilite">req.headers[param]</code></td>
</tr>
</tbody>
</table>
<h2 id="more-endpoints">More Endpoints</h2>
<p>We have already created an endpoint to fetch the data (<strong>GET</strong> route). It'd be great to provide a way of creating the new records too.
 Let's create the <strong>POST</strong> handler:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">Controller</span><span class="p">,</span> <span class="nx">Get</span><span class="p">,</span> <span class="nx">Post</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>

<span class="kd">@Controller</span><span class="p">(</span><span class="s1">&#39;cats&#39;</span><span class="p">)</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">CatsController</span> <span class="p">{</span>
    <span class="kd">@Post</span><span class="p">()</span>
    <span class="nx">create() {</span>
        <span class="c1">// TODO: Add some logic here</span>
    <span class="p">}</span>

    <span class="kd">@Get</span><span class="p">()</span>
    <span class="nx">findAll() {</span>
        <span class="k">return</span> <span class="p">[];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>It's really easy. Nest provides the rest of those endpoints decorators in the same fashion - <code class="codehilite">@Put()</code>, <code class="codehilite">@Delete()</code>, <code class="codehilite">@Patch()</code>, <code class="codehilite">@Options()</code>, <code class="codehilite">@Head()</code>, and <code class="codehilite">@All()</code>.</p>
<h2 id="status-code-manipulation">Status Code Manipulation</h2>
<p>As mentioned, the response <strong>status code</strong> is always 200 by default, except POST requests, when it's <strong>201</strong>. We can easily change this behavior by adding the <code class="codehilite">@HttpCode(...)</code> decorator at a handler-level.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">Controller</span><span class="p">,</span> <span class="nx">Get</span><span class="p">,</span> <span class="nx">Post</span><span class="p">,</span> <span class="nx">HttpStatus</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>

<span class="kd">@Controller</span><span class="p">(</span><span class="s1">&#39;cats&#39;</span><span class="p">)</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">CatsController</span> <span class="p">{</span>
    <span class="kd">@HttpStatus</span><span class="p">(</span><span class="mi">204</span><span class="p">)</span>
    <span class="kd">@Post</span><span class="p">()</span>
    <span class="nx">create() {</span>
        <span class="c1">// TODO: Add some logic here</span>
    <span class="p">}</span>

    <span class="kd">@Get</span><span class="p">()</span>
    <span class="nx">findAll() {</span>
        <span class="k">return</span> <span class="p">[];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h2 id="route-parameters">Route parameters</h2>
<p>Routes with static paths can't help when you need to accept <strong>dynamic data</strong> as part of the URL.
To define routes with route parameters, simply specify the route parameters in the path of the route as shown below.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">@Get</span><span class="p">(</span><span class="s1">&#39;:id&#39;</span><span class="p">)</span>
<span class="nx">findOne</span><span class="p">(</span><span class="kd">@Param</span><span class="p">()</span> <span class="nx">params</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">{};</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h2 id="async-await">Async / Await</h2>
<p>We love modern JavaScript, and we know that the data extraction is mostly <strong>asynchronous</strong>. That's why Nest supports <code class="codehilite">async</code> functions, and works pretty well with them.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Learn more about <code class="codehilite">async / await</code> <a href="https://kamilmysliwiec.com/typescript-2-1-introduction-async-await">here</a>!</p>
</div>
<p>Every async function has to return the <code class="codehilite">Promise</code>. It means that you can return deffered value and Nest will resolve it by itself. Let's have a look on the below example:</p>
<h3 id="typescript_1">TypeScript</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">@Get</span><span class="p">()</span>
<span class="nx">async</span> <span class="nx">findAll</span><span class="p">()</span><span class="o">:</span> <span class="nx">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="p">[]</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[];</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h3 id="javascript_1">JavaScript</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">@</span><span class="nx">Get</span><span class="p">()</span>
<span class="nx">async</span> <span class="nx">findAll</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[];</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h2 id="observables">Observables</h2>
<p>Furthermore, Nest route handlers are even more powerful. They can return the RxJS <a href="http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html">observable streams</a>. It makes the migration between a simple web application and the Nest microservice much easier.</p>
<h3 id="typescript_2">TypeScript</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">@Get</span><span class="p">()</span>
<span class="nx">findAll</span><span class="p">()</span><span class="o">:</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">any</span><span class="p">[]</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">Observable</span><span class="p">.</span><span class="nx">of</span><span class="p">([]);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h3 id="javascript_2">JavaScript</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">@</span><span class="nx">Get</span><span class="p">()</span>
<span class="nx">findAll</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">Observable</span><span class="p">.</span><span class="k">of</span><span class="p">([]);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>There is no "best practice" in this regard; use whatever format suits your needs.</p>
<h2 id="post-handler">POST handler</h2>
<p>That's strange that this POST route handler doesn't accept any client params. We should at least expect the <code class="codehilite">@Body()</code> argument here.</p>
<p>Firstly, we need to establish the <strong>DTO</strong> (Data Transfer Object) schema. A DTO is an object that defines how the data will be sent over the network. We could do it using <strong>TypeScript</strong> interfaces, or by simple classes. What may be surprising, we recommend using <strong>classes</strong> here. Why? The classes are the part of the JavaScript ES6 standard, so they're just plain functions. On the other hand, TypeScript interfaces are removed during the transpilation, Nest can't refer to them. It's important because features such as <strong>Pipes</strong> enables additional possibilities when they've access to the metatype of the variable.</p>
<p>Let's create the <code class="codehilite">CreateCatDto</code>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">export</span> <span class="kr">class</span> <span class="nx">CreateCatDto</span> <span class="p">{</span>
    <span class="nx">readonly</span> <span class="nx">name</span>: <span class="kt">string</span><span class="p">;</span>
    <span class="nx">readonly</span> <span class="nx">age</span>: <span class="kt">number</span><span class="p">;</span>
    <span class="nx">readonly</span> <span class="nx">breed</span>: <span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>It has only three basic properties. All of them are marked as a <code class="codehilite">readonly</code>, because we should always try to make our functions as <a href="https://medium.com/javascript-scene/master-the-javascript-interview-what-is-a-pure-function-d1c076bec976">pure</a> as possible.</p>
<p>Now we can use the schema inside the <code class="codehilite">CatsController</code>:</p>
<h3 id="typescript_3">TypeScript</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">@Post</span><span class="p">()</span>
<span class="nx">async</span> <span class="nx">create</span><span class="p">(</span><span class="kd">@Body</span><span class="p">()</span> <span class="nx">createCatDto</span>: <span class="kt">CreateCatDto</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// TODO: Add some logic here</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h3 id="javascript_3">JavaScript</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">@</span><span class="nx">Post</span><span class="p">()</span>
<span class="err">@</span><span class="nx">Bind</span><span class="p">(</span><span class="nx">Body</span><span class="p">())</span>
<span class="nx">async</span> <span class="nx">create</span><span class="p">(</span><span class="nx">createCatDto</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// TODO: Add some logic here</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h2 id="error-handling">Error Handling</h2>
<p><!-- TODO: UPDATE LINK -->
There's a separated chapter about working with the exceptions <a routerLink="/exception-filters">here</a>.</p>
<h2 id="last-step">Last Step</h2>
<p>The controller is prepared, and ready to use, but Nest doesn't know that <code class="codehilite">CatsController</code> exists yet, so it won't create an instance of this class. We need to tell about it.</p>
<p>The controller always belongs to the module, that's why we hold <code class="codehilite">controllers</code> array within <code class="codehilite">@Module()</code> decorator. Since we don't have any other modules except the root <code class="codehilite">ApplicationModule</code>, let's use it for now:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">Module</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">CatsController</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./cats/cats.controller&#39;</span><span class="p">;</span>

<span class="kd">@Module</span><span class="p">({</span>
    <span class="nx">controllers</span><span class="o">:</span> <span class="p">[</span><span class="nx">CatsController</span><span class="p">],</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">ApplicationModule</span> <span class="p">{</span> <span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Tada! We attached the metadata to the module class, so now Nest can easily reflect which controllers have to be mounted.</p>
<h2 id="express-approach">Express Approach</h2>
<p>The second way of manipulating the response is to use express <a href="http://expressjs.com/en/api.html#res">response</a> object. It was the only available option until <strong>Nest 4</strong>. To inject the response object, we need to use <code class="codehilite">@Res()</code> decorator. To show the differences, i'm going to rewrite the <code class="codehilite">CatsController</code>:</p>
<h3 id="typescript_4">TypeScript</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">Controller</span><span class="p">,</span> <span class="nx">Get</span><span class="p">,</span> <span class="nx">Post</span><span class="p">,</span> <span class="nx">Res</span><span class="p">,</span> <span class="nx">Body</span><span class="p">,</span> <span class="nx">HttpStatus</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">CreateCatDto</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./dto/create-cat.dto&#39;</span><span class="p">;</span>

<span class="kd">@Controller</span><span class="p">(</span><span class="s1">&#39;cats&#39;</span><span class="p">)</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">CatsController</span> <span class="p">{</span>
    <span class="kd">@Post</span><span class="p">()</span>
    <span class="nx">create</span><span class="p">(</span><span class="kd">@Res</span><span class="p">()</span> <span class="nx">res</span><span class="p">,</span> <span class="kd">@Body</span><span class="p">()</span> <span class="nx">createCatDto</span>: <span class="kt">CreateCatDto</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// TODO: Add some logic here</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">CREATED</span><span class="p">).</span><span class="nx">send</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">@Get</span><span class="p">()</span>
    <span class="nx">findAll</span><span class="p">(</span><span class="kd">@Res</span><span class="p">()</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">OK</span><span class="p">).</span><span class="nx">json</span><span class="p">([]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<h3 id="javascript_4">JavaScript</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">Controller</span><span class="p">,</span> <span class="nx">Get</span><span class="p">,</span> <span class="nx">Post</span><span class="p">,</span> <span class="nx">Bind</span><span class="p">,</span> <span class="nx">Res</span><span class="p">,</span> <span class="nx">Body</span><span class="p">,</span> <span class="nx">HttpStatus</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@nestjs/common&#39;</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Controller</span><span class="p">(</span><span class="s1">&#39;cats&#39;</span><span class="p">)</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">CatsController</span> <span class="p">{</span>
    <span class="err">@</span><span class="nx">Post</span><span class="p">()</span>
    <span class="err">@</span><span class="nx">Bind</span><span class="p">(</span><span class="nx">Res</span><span class="p">(),</span> <span class="nx">Body</span><span class="p">())</span>
    <span class="nx">create</span><span class="p">(</span><span class="nx">res</span><span class="p">,</span> <span class="nx">createCatDto</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// TODO: Add some logic here</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">CREATED</span><span class="p">).</span><span class="nx">send</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="err">@</span><span class="nx">Get</span><span class="p">()</span>
    <span class="err">@</span><span class="nx">Bind</span><span class="p">(</span><span class="nx">Res</span><span class="p">())</span>
    <span class="nx">findAll</span><span class="p">(</span><span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="nx">HttpStatus</span><span class="p">.</span><span class="nx">OK</span><span class="p">).</span><span class="nx">json</span><span class="p">([]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>This manner is much less clear from my point of view. I definitely prefer the first approach, but to make the Nest <strong>backward compatible</strong> with the previous versions, this method is still available. Also, the <strong>response object</strong> gives more flexibility - you've full control of the response.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../introduction/" title="Introduction" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Introduction
              </span>
            </div>
          </a>
        
        
          <a href="../components/" title="Components" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Components
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 - Orbital Team. Docs are served under the MIT License.
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/orbital-js" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/nestframework" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://orbital.sh" class="md-footer-social__link fa fa-globe"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.9fb73e57.js"></script>
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
        <script src="../../assets/scripts/load-contributors.js"></script>
      
    
    
      
    
  </body>
</html>